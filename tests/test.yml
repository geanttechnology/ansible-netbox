---
- hosts: localhost
  connection: local
  gather_facts: false
  vars:
    netbox_regions:
      - name: US
        state: present
      - name: East
        parent: US
        state: present
      - name: North Virginia
        parent: East
        state: present
      - name: Ohio
        parent: East
        state: present
      - name: West
        parent: US
        state: present
      - name: North California
        parent: West
        state: present
      - name: Oregon
        parent: West
        state: present
      - name: Asia Pacific
        state: present
      - name: Hong Kong
        parent: Asia Pacific
        state: present
      - name: Mumbai
        parent: Asia Pacific
        state: present
      - name: Osaka-Local
        parent: Asia Pacific
        state: present
      - name: Seoul
        parent: Asia Pacific
        state: present
      - name: Singapore
        parent: Asia Pacific
        state: present
      - name: Sydney
        parent: Asia Pacific
        state: present
      - name: Tokyo
        parent: Asia Pacific
        state: present
      - name: China
        state: present
      - name: Beijing
        parent: China
        state: present
      - name: Ningxia
        parent: China
        state: present
      - name: EU
        state: present
      - name: Frankfurt
        parent: EU
        state: present
      - name: Ireland
        parent: EU
        state: present
      - name: London
        parent: EU
        state: present
      - name: Paris
        parent: EU
        state: present
      - name: Stockholm
        parent: EU
        state: present
    netbox_sites:
      - asn: 65001
        comments: ""
        contact_email: johndoe@example.org
        contact_name: John Doe
        contact_phone: 111-111-1111
        custom_fields: {}
        description: ""
        facility: AT&T
        # latitude: null
        # longitude: null
        name: ATT
        physical_address: ""
        region: East
        shipping_address: ""
        state: present
        status: Active
        tags: ["ATT", "Customer1"]
        tenant: Customer1
        time_zone: US/Eastern
      - asn: 65002
        comments: ""
        contact_email: janedoe@example.org
        contact_name: Jane Doe
        contact_phone: 222-222-2222
        custom_fields: {}
        description: ""
        facility: QTS
        # latitude: null
        # longitude: null
        name: QTS
        physical_address: ""
        region: East
        shipping_address: ""
        state: present
        status: Retired
        tags: ["QTS", "Customer2"]
        tenant: Customer2
        time_zone: US/Eastern
    netbox_tags:
      - name: Monitored
        color: 4caf50
        state: present
        comments: Monitored Tag
      - name: Not Monitored
        color: aa1409
        state: present
        comments: Not Monitored Tag
    netbox_tenant_groups:
      - name: Acquisitions
        state: present
      - name: Customers
        state: present
    netbox_tenants:
      - name: Acquisition1
        group: Acquisitions
        state: present
        description: Acquisition 1 Tenant
        comments: Acquisition 1 Tenant
        tags:
          - Not Monitored
      - name: Customer1
        group: Customers
        state: present
        description: Customer 1 Tenant
        comments: Customer 1 Tenant
        tags:
          - Monitored
      - name: Customer2
        group: Customers
        state: present
        description: Customer 2 Tenant
        comments: Customer 2 Tenant
        tags:
          - Monitored

    netbox_token: 4f552cc2e8c3b76d9613a591e3adb58984a19a6f
    netbox_url: http://127.0.0.1:8080

  tasks:
    - name: Manage Region(s)
      nbox_region:
        name: "{{ item['name'] }}"
        parent: "{{ item['parent']|default(omit) }}"
        netbox_token: "{{ netbox_token }}"
        netbox_url: "{{ netbox_url }}"
        state: "{{ item['state']|default('present') }}"
      loop: "{{ netbox_regions }}"

    - name: Manage Tag(s)
      nbox_tag:
        color: "{{ item['color']|default(omit) }}"
        comments: "{{ item['comments']|default(omit) }}"
        name: "{{ item['name'] }}"
        netbox_token: "{{ netbox_token }}"
        netbox_url: "{{ netbox_url }}"
        state: "{{ item['state']|default('present') }}"
      loop: "{{ netbox_tags }}"

    - name: Manage Tenant Group(s)
      nbox_tenant_group:
        name: "{{ item['name'] }}"
        netbox_token: "{{ netbox_token }}"
        netbox_url: "{{ netbox_url }}"
        state: "{{ item['state']|default('present') }}"
      loop: "{{ netbox_tenant_groups }}"

    - name: Manage Tenant(s)
      nbox_tenant:
        comments: "{{ item['comments']|default(omit) }}"
        description: "{{ item['description']|default(omit) }}"
        group: "{{ item['group']|default(omit) }}"
        name: "{{ item['name'] }}"
        netbox_token: "{{ netbox_token }}"
        netbox_url: "{{ netbox_url }}"
        state: "{{ item['state']|default('present') }}"
        tags: "{{ item['tags']|default(omit) }}"
      loop: "{{ netbox_tenants }}"

    - name: Manage Site(s)
      nbox_site:
        asn: "{{ item['asn']|default(omit) }}"
        comments: "{{ item['comments']|default(omit) }}"
        contact_email: "{{ item['contact_email']|default(omit) }}"
        contact_name: "{{ item['contact_name']|default(omit) }}"
        contact_phone: "{{ item['contact_phone']|default(omit) }}"
        custom_fields: "{{ item['custom_fields']|default(omit) }}"
        description: "{{ item['description']|default(omit) }}"
        facility: "{{ item['facility']|default(omit) }}"
        latitude: "{{ item['latitude']|default(omit) }}"
        longitude: "{{ item['longitude']|default(omit) }}"
        name: "{{ item['name'] }}"
        netbox_token: "{{ netbox_token }}"
        netbox_url: "{{ netbox_url }}"
        physical_address: "{{ item['physical_address']|default(omit) }}"
        region: "{{ item['region']|default(omit) }}"
        shipping_address: "{{ item['shipping_address']|default(omit) }}"
        state: "{{ item['state']|default('present') }}"
        status: "{{ item['status'] }}"
        tags: "{{ item['tags']|default(omit) }}"
        tenant: "{{ item['tenant']|default(omit) }}"
        time_zone: "{{ item['time_zone']|default(omit) }}"
      loop: "{{ netbox_sites }}"
